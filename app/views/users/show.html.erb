<h1 class="text-2xl font-bold mb-4"><%= @user.name %></h1>

<ul class="mb-4">
  <li><strong>Kullanıcı Adı:</strong> <%= @user.username %></li>
  <li><strong>E-posta:</strong> <%= @user.email %></li>
  <li><strong>Telefon:</strong> <%= @user.phone %></li>
  <li><strong>Web Sitesi:</strong> <%= @user.website %></li>
</ul>

<h2 class="text-lg font-semibold mt-6 mb-2">Albümler</h2>
<ul class="space-y-2">
  <% @albums.each do |album| %>
    <li>
      <a href="#" class="album-link text-blue-500 hover:underline" data-album-id="<%= album['id'] %>"><%= album['title'] %></a>
    </li>
  <% end %>
</ul>

<!-- Modal Penceresi -->
<div id="albumModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <div id="album-details">
      <!-- Albüm detayları buraya yüklenecek -->
    </div>
  </div>
</div>

<style>
  .modal {
    display: none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.4);
  }
  .modal-content {
    background-color: #fefefe;
    margin: 15% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
  }
  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }
  .close:hover,
  .close:focus {
    color: black;
    text-decoration: none;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const modal = document.getElementById('albumModal');
    const span = document.querySelector('.close');

    document.querySelectorAll('.album-link').forEach(function(link) {
      link.addEventListener('click', function(event) {
        event.preventDefault();
        const albumId = this.getAttribute('data-album-id');

        fetch(`/users/<%= @user.id %>/album_details/${albumId}`)
          .then(response => response.json())
          .then(data => {
            if (data.error) {
              document.getElementById('album-details').innerHTML = `<p>${data.error}</p>`;
            } else {
              document.getElementById('album-details').innerHTML = `
                <h3 class="text-xl font-semibold mb-2">${data.title}</h3>
                <p><strong>Album ID:</strong> ${data.id}</p>
                <p><strong>URL:</strong> <a href="${data.url}" target="_blank" class="text-blue-500">${data.url}</a></p>
                <img src="${data.thumbnailUrl}" alt="${data.title}" class="mt-2">
              `;
            }
            modal.style.display = 'block';
          })
          .catch(error => {
            console.error('Error:', error);
            document.getElementById('album-details').innerHTML = '<p>Bir hata oluştu.</p>';
            modal.style.display = 'block';
          });
      });
    });

    span.onclick = function() {
      modal.style.display = 'none';
    };

    window.onclick = function(event) {
      if (event.target === modal) {
        modal.style.display = 'none';
      }
    };
  });
</script>
